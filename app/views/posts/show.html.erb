<h2>投稿詳細</h2>

<div class="container">
  <div class="form-group row">
    <%= attachment_image_tag @post, :image, :fill,600 ,200, format: "jpeg" %>
  </div>
  <div class="form-group row">
    <div class="col-sm-3">
      観光地
    </div>
    <div>
      <%= @post.tourist_spot %>
    </div>
  </div>
  <div class="form-group row">
    <div class="col-sm-3">
      都道府県
    </div>
    <div>
      <%= @post.prefecture %>
    </div>
  </div>
  <div class="form-group row">
    <div class="col-sm-3">
      住所
    </div>
    <div>
      <%= @post.address %>
    </div>
  </div>
  <div class="form-group row">
    <div class="col-sm-3">
      内容
    </div>
    <div>
      <%= @post.body %>
    </div>
  </div>


  <%# @posts.reverse_each do |post| %>
    <div id="post_<%= @post.id %>">
      <%= render 'post', post: @post%>
    </div>
  <%# end %>



  <div class="form-group row">
    <div class="col-sm-3">
      <%= link_to "編集", edit_post_path(@post), class: "btn btn-success" %>
      <%= link_to "削除", post_path(@post), method: :delete, class: "btn btn-success" %>
    </div>
  </div>
  <div>
    <% if @post.gooded_by?(current_user) %>
      <%= link_to post_goods_path(@post), method: :delete do %>
      ♥<%= @post.goods.count %>いいね
      <% end %>
    <% else %>
      <%= link_to post_goods_path(@post), method: :post do %>
      ♡<%= @post.goods.count %>いいね
      <% end %>
    <% end %>
  </div>

  <div class="form-group row">
    <div class="col-sm-7">
       <% @post.post_comments.each do |post_comment| %>
        <div>
            <!-- <%#= profile_image_tag %> -->
            <%= post_comment.user.name %>
            <%= post_comment.comment %>
        </div>
      <% end %>

      <div>
        <%= form_with(model:[@post, @post_comment],local: true) do |f| %>
          <%= f.text_field :comment, placeholder: "コメント追加" %>
          <%= f.submit "送信", class: "btn btn-success" %>
        <% end %>
      </div>
    </div>
  </div>
</div>


<p>住所</p>
<div id="map"></div>
<style>
#map{
  height: 500px;
  width:500px;
}
</style>

<script type="text/javascript">
    function initMap() {

        var test ={lat: <%= @post.latitude %>, lng: <%= @post.longitude %>};
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 15,
            center: test
        });

      var contentString = '住所：<%= @post.address %>';
        var infowindow = new google.maps.InfoWindow({
            content: contentString
        });

        var marker = new google.maps.Marker({
            position:test,
            map: map,
            title: contentString
        });

        marker.addListener('click', function() {
            infowindow.open(map, marker);
        });
    }
</script>

<script async defer
        src="https://maps.googleapis.com/maps/api/js?v=3.exp&key=<%= ENV['GOOGLE_MAP_API_KEY'] %>&callback=initMap">
</script>